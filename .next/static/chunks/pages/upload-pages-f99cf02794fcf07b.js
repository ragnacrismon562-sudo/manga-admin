(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[847],{153:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload-pages",function(){return a(4473)}])},7317:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(5893),s=a(1664),l=a.n(s),n=a(1163),d=a(7294),i=a(1046);function o(){let e=(0,n.useRouter)(),[t,a]=(0,d.useState)(null),[s,o]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1);(0,d.useEffect)(()=>{window.matchMedia("(prefers-color-scheme: dark)").matches&&(o(!0),document.documentElement.classList.add("dark"))},[]),(0,d.useEffect)(()=>{i.O.auth.getSession().then(e=>{let{data:{session:t}}=e;a(null==t?void 0:t.user)});let{data:{subscription:e}}=i.O.auth.onAuthStateChange((e,t)=>{a(null==t?void 0:t.user)});return()=>null==e?void 0:e.unsubscribe()},[]);let h=async()=>{await i.O.auth.signOut(),e.push("/login")};if(!t)return null;let m=[{href:"/",label:"Dashboard",icon:"\uD83D\uDCCA"},{href:"/add-manga",label:"Add Manga",icon:"\uD83D\uDCDA"},{href:"/add-chapter",label:"Add Chapter",icon:"\uD83D\uDCD6"},{href:"/upload-pages",label:"Upload Pages",icon:"\uD83D\uDCF8"}];return(0,r.jsx)("nav",{className:"bg-gradient-to-r from-blue-600 to-blue-700 dark:from-blue-900 dark:to-blue-800 text-white shadow-lg sticky top-0 z-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCDA"}),(0,r.jsx)(l(),{href:"/",className:"font-bold text-xl hover:text-blue-100 transition-colors",children:"Manga Admin"})]}),(0,r.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:m.map(t=>(0,r.jsx)(l(),{href:t.href,children:(0,r.jsxs)("button",{className:"px-4 py-2 rounded-lg transition-colors ".concat(e.pathname===t.href?"bg-blue-800 dark:bg-blue-700":"hover:bg-blue-700 dark:hover:bg-blue-700"),children:[t.icon," ",t.label]})},t.href))}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[(0,r.jsx)("button",{onClick:()=>{o(!s),s?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark")},className:"p-2 hover:bg-blue-700 dark:hover:bg-blue-700 rounded-lg transition-colors",title:s?"Light mode":"Dark mode",children:s?"☀️":"\uD83C\uDF19"}),(0,r.jsx)("div",{className:"hidden sm:flex items-center space-x-2 px-3 py-2 bg-blue-700 dark:bg-blue-800 rounded-lg",children:(0,r.jsx)("span",{className:"text-sm font-medium truncate max-w-[150px]",children:null==t?void 0:t.email})}),(0,r.jsx)("button",{onClick:h,className:"px-4 py-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors font-semibold text-sm",children:"Logout"}),(0,r.jsx)("button",{onClick:()=>u(!c),className:"md:hidden p-2 hover:bg-blue-700 rounded-lg transition-colors",children:c?"✕":"☰"})]})]}),c&&(0,r.jsx)("div",{className:"md:hidden pb-4 space-y-2",children:m.map(t=>(0,r.jsx)(l(),{href:t.href,children:(0,r.jsxs)("button",{className:"w-full text-left px-4 py-2 rounded-lg transition-colors ".concat(e.pathname===t.href?"bg-blue-800 dark:bg-blue-700":"hover:bg-blue-700 dark:hover:bg-blue-700"),children:[t.icon," ",t.label]})},t.href))})]})})}},1046:function(e,t,a){"use strict";a.d(t,{O:function(){return r}});let r=(0,a(2629).eI)("https://bdbpkmvxnbyaykfxbnft.supabase.co","oEz8e5NLLLOGA6TNKVs2YD0JXnF98Zu7DrztmO7ndXprNiHtc6by1N6TKV04C7i2qJkVn16yWy+6Frl3InfmOg==")},4473:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var r=a(5893),s=a(7294),l=a(1163),n=a(9008),d=a.n(n),i=a(1046),o=a(7317);function c(){let e=(0,l.useRouter)(),[t,a]=(0,s.useState)(null),[n,c]=(0,s.useState)([]),[u,h]=(0,s.useState)([]),[m,g]=(0,s.useState)(""),[x,b]=(0,s.useState)(""),[p,f]=(0,s.useState)([]),[y,k]=(0,s.useState)(!1),[j,v]=(0,s.useState)(""),[N,w]=(0,s.useState)("");(0,s.useEffect)(()=>{i.O.auth.getSession().then(t=>{let{data:{session:r}}=t;r?(a(r.user),D()):e.push("/login")})},[e]);let D=async()=>{try{let{data:e,error:t}=await i.O.from("manga").select("id, title").order("title");if(t)throw t;c(e||[])}catch(e){console.error("Error fetching manga:",e)}},C=async e=>{try{let{data:t,error:a}=await i.O.from("chapters").select("id, chapter_number, title").eq("manga_id",e).order("chapter_number");if(a)throw a;h(t||[])}catch(e){console.error("Error fetching chapters:",e)}},_=async t=>{if(t.preventDefault(),!x){v("Please select a chapter");return}if(0===p.length){v("Please select at least one image");return}k(!0),v(""),w("");try{let{data:t}=await i.O.from("pages").select("page_number").eq("chapter_id",x).order("page_number",{ascending:!1}).limit(1),a=1;t&&t.length>0&&(a=t[0].page_number+1);let r=p.map(async(e,t)=>{let r="chapter-".concat(x,"-page-").concat(a+t,".jpg");return{chapter_id:x,page_number:a+t,image_url:"https://placeholder-image.com/".concat(r)}}),s=await Promise.all(r),{data:l,error:n}=await i.O.from("pages").insert(s);if(n)throw n;w("Successfully uploaded ".concat(p.length," pages!")),f([]),setTimeout(()=>e.push("/"),2e3)}catch(e){v(e.message)}k(!1)};return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d(),{children:(0,r.jsx)("title",{children:"Upload Pages - Manga Admin"})}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)(o.Z,{}),(0,r.jsxs)("main",{className:"max-w-2xl mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-8",children:"Upload Manga Pages"}),(0,r.jsxs)("form",{onSubmit:_,className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 space-y-6",children:[j&&(0,r.jsx)("div",{className:"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 px-4 py-3 rounded",children:j}),N&&(0,r.jsx)("div",{className:"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200 px-4 py-3 rounded",children:N}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-semibold mb-2",children:"Select Manga *"}),(0,r.jsxs)("select",{value:m,onChange:e=>{let t=e.target.value;g(t),b(""),t?C(t):h([])},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Choose a manga..."}),n.map(e=>(0,r.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),m&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-semibold mb-2",children:"Select Chapter *"}),(0,r.jsxs)("select",{value:x,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Choose a chapter..."}),u.map(e=>(0,r.jsxs)("option",{value:e.id,children:["Chapter ",e.chapter_number," ",e.title&&"- ".concat(e.title)]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 text-sm font-semibold mb-2",children:"Select Images *"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500",children:[(0,r.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{f(Array.from(e.target.files||[]))},className:"hidden",id:"file-input"}),(0,r.jsxs)("label",{htmlFor:"file-input",className:"cursor-pointer block",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,r.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-8l-3.172-3.172a4 4 0 00-5.656 0L28 16M8 24h32",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,r.jsx)("span",{className:"mt-2 block text-sm font-medium text-gray-600 dark:text-gray-300",children:"Click to upload or drag and drop"}),(0,r.jsx)("span",{className:"mt-1 block text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB each"})]})]}),p.length>0&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:["Selected files: ",p.length]}),(0,r.jsx)("ul",{className:"space-y-1",children:p.map((e,t)=>(0,r.jsx)("li",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.name},t))})]})]}),(0,r.jsx)("button",{type:"submit",disabled:y,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-2 rounded-lg transition-colors",children:y?"Uploading...":"Upload Pages"})]})]})]})]}):(0,r.jsx)("div",{children:"Loading..."})}}},function(e){e.O(0,[809,664,888,774,179],function(){return e(e.s=153)}),_N_E=e.O()}]);